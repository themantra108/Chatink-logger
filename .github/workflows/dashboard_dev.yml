name: âš¡ Fast Dashboard Build

# TRIGGER: Runs immediately when you push changes to 'dashboard.jl'
# OR when you click the manual button.
on:
  workflow_dispatch:
  push:
    paths:
      - 'dashboard.jl'  # Only triggers if you edit the dashboard code

permissions:
  contents: write

jobs:
  hot-reload:
    runs-on: ubuntu-latest
    
    steps:
      - name: Check out repository ğŸ› ï¸
        uses: actions/checkout@v4

      - name: Set up Julia ğŸš€
        uses: julia-actions/setup-julia@v2
        with:
          version: '1'

      - name: Cache Julia artifacts ğŸ’¾
        uses: julia-actions/cache@v2

      - name: Instantiate Dependencies ğŸ“¦
        run: julia --project=. -e 'using Pkg; Pkg.instantiate()'

      # âš¡ SKIP SCRAPING -> JUMP STRAIGHT TO BUILDING
      - name: Rebuild HTML ğŸ—ï¸
        run: julia --project=. dashboard.jl

      - name: Deploy to GitHub Pages ğŸŒ
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          keep_files: true
